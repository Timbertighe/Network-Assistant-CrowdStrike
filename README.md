# CrowdStrike plugin
Handles webhooks from the CrowdStrike platform

# Using the plugin
Plugins need to be added to the 'plugins' directory of the Network Assistant, each in their own folder.
Plugins are then enabled in the global configuration file

## Webhooks
### Enabling Webhooks
    This requires webhook alerts to be configured on CrowdStrike
    Configure the webhook plugin with a destination and secret
      Optionally the authentication header can be changed
    Then configure a notification workflow to use the defined webhook
    https://www.crowdstrike.com/blog/tech-center/notification-workflows/
    
### Webhook Authentication
    CrowdStrike webook authentication uses the 'X-Cs-Primary-Signature' header
    This contains a secret that is defined by CrowdStrike when they send the webhook
    The signature is generated by concatenating the message body with the 'X-Cs-Delivery-Timestamp' header, and generating an HMAC-SHA256 secret
      The body needs to be decoded to utf-8
          

## Configuration
### Overview
    Plugin configuration is in the 'config.yaml' file
    
#### Plugin Config
    Set 'webhook_secret' to the secret, as set in the CrowdStrike webhook configuration
    Set the 'auth_header' to X-Cs-Primary-Signature, or the custom header you configured on the CS platform


&nbsp;<br>
- - - -
## Files
### config.yaml
    A YAML file that contains all the config for the plugin
    This includes:
        * webhook_secret - The secret we expect to see from the device sending the webhook
        * auth_header - The header we expect to see in the webhook message
        * chat_id - The chat ID to send alerts to

&nbsp;<br>
### crowdstrike.py
    The CrowdStrikeHandler class that handles events as they are received
    
#### __init__()
    Class constructor

    Reads config from the config file
    auth_header and auth_secret are values used to webhook authentication
    No SQL table yet

    Parameters
    ----------
    None

    Raises
    ------
    None

    Returns
    -------
    None
        
#### handle_event()
    Handles a webhook from CrowdStrike

    Parameters
    ----------
    raw_response : dict
        The webhook body
    src : str
        The IP that sent the webhook

    Raises
    ------
    Exception
        If certain fields don't exist in the webhook

    Returns
    -------
    None

#### authenticate()
    Authenticate a webhook from CrowdStrike

    Parameters
    ----------
    request : class (3rd party)
        The webhook, including headers
    plugin : dict
        Config information

    Raises
    ------
    Exception
        None

    Returns
    -------
    True : bool
        If the webhook has been authenticated
    False : bool
        If the webhook was not authenticated
